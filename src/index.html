<!DOCTYPE html>
<html>
	<head>
        <link rel="import" href="./userModules/export-level.html">
        <link rel="import" href="./userModules/import-level.html">
        <link rel="import" href="./userModules/tool-bar.html">
		<link rel="import" href="./bower_components/paper-button/paper-button.html">
		<link rel="import" href="./bower_components/paper-checkbox/paper-checkbox.html">
		<script src="./js/lvl.js"></script>
		<script src="./js/popupManager.js"></script>
        
		<script>
			const level = new lvl('build');
			var darkbox;
			var gridbox;
			var mngr;
			
			function generateExportView(){
				return new ExportLevel(mngr);
			}
			
			function generateImportView(){
				return new ImportLevel(mngr);
			}
			
			window.onload = function(){
				mngr = new popupManager();
				document.getElementById('placeholder').appendChild(level.generateBoard());
				
				darkbox = document.getElementById('dark');
				gridbox = document.getElementById('gridbox');
				darkbox.onchange = function(){
					level.setDark(!level.setDarkdark);
				}
				gridbox.onchange = function(){
					if(gridbox.checked){
						level.enableGrid();
					}else{
						level.disableGrid();
					}
				}
			}

			function openExportPopup(){
				mngr.openPopup(generateExportView());
			}

			function openImportPopup(){
				mngr.openPopup(generateImportView());
			}

			function importlvl1D(){
				var data = document.getElementById('interface').value;
				level.import1D(data);
			}
			/*window.ondragstart = function(){
				return false;
			}*/
           
			level.ondarkchange = function(value){
				darkbox.checked = value;
			}
            /*var resizeTarget;
            function startResize(e){
                window.addEventListener('mousemove', resize, false);
                window.addEventListener('mouseup', endResize, false);
                resizeTarget = e.target.parentNode;
                console.log(e);
            }
            function resize(e){
                resizeTarget.style.width = (e.clientX - resizeTarget.offsetLeft) + 'px';
                console.log(e);
                console.log(resizeTarget.width);
            }
            function endResize(){
            
            }  */
		</script>
		<!--<style>
			* {
    				-webkit-touch-callout:none;
    				-webkit-user-select:none;
  				    -moz-user-select:none;
    				-ms-user-select:none;
    				user-select:none;
			}
		</style>-->
		<style is="custom-style">
				paper-button.export{
					background-color: #FF0000;
					--paper-button-ink-color: #303030;
					color: #000000;
				}	
				paper-button.import{
					background-color: #FF0000;
					--paper-button-ink-color: #303030;
					color: #000000;
				}
				paper-toggle-button.grid{
					--paper-toggle-button-checked-bar-color: #FF0000;
					--paper-toggle-button-checked-button-color: #FF0000;
				}
		</style>
	</head>
	<body style="background-color: #303030">
		    <tool-bar style="z-index: -1;"></tool-bar>
			<div id="placeholder" style="">
                <!--<div style="width:10px;height:10px;border-radius: 5px; background-color: blue; position: absolute; bottom: 25px; right: 180px;" onmousedown="startResize(event);"></div>-->
            </div>
			<div style="width:800px; bottom:-20px; position:relative; background-color: #777777; border: 2px solid black; height: 50px; border-radius: 50px;">
				<paper-button raised onclick="openExportPopup()" class = "export" style="position:absolute; top:5px; height: 40px; left:25px;">Export</paper-button>
				<paper-button raised onclick="openImportPopup()" class = "import" style="position:absolute; top:5px; height: 40px; left:125px;">Import</paper-button>
				<paper-toggle-button id="gridbox" style="left: 225px;position:absolute;top:5px; height: 40px;" class="grid" checked>Enable Grid</paper-toggle-button>
			</div>
            <div style="outline:2px solid; width:800px; bottom:-40px; position:relative; background-color: white;">
				<textarea id="interface" style="width:400px"></textarea>
				<input id="dark" type="checkbox">Dark
			</div>
		</div>
	</body>
</html>
